<!DOCTYPE html>
<html lang="en">
	<head>

		<title>Hello DataVisual</title>
			
		<!-- threeJs -->
		 <script src="lib/three.min.js"></script> 
		 <script src="lib/GLTFLoader.js"></script> 		
		 <script src="lib/OrbitControls.js"></script> 		

		<!-- DataVisual -->
		<script src="lib/dataVisual.js" ></script> 
		
	</head>

	<body id="container">
	
		<span>Hello <a href="https://github.com/mariodelgadosr/dataVisual">DataVisual</a>: Mouseover scene to identify objects with joined data. gltf File in scene: <a href="https://raw.githubusercontent.com/KhronosGroup/glTF-Sample-Models/master/2.0/CesiumMilkTruck/glTF-Embedded/CesiumMilkTruck.gltf">CesiumMilkTruck.gltf</a></span>
		
		<script>
		
			const scene = new THREE.Scene();
				  scene.background = new THREE.Color("#1c4a63") ;
			const camera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 0.1, 1000 );
			
			const renderer = new THREE.WebGLRenderer();
			renderer.setSize( window.innerWidth, window.innerHeight);
			document.body.appendChild( renderer.domElement );	
			
			const controls = new THREE.OrbitControls( camera, renderer.domElement );  			
			
			const gltfLoader = new THREE.GLTFLoader(); // https://threejs.org/docs/index.html#examples/loaders/GLTFLoader

			const gltfURL = "https://raw.githubusercontent.com/KhronosGroup/glTF-Sample-Models/master/2.0/CesiumMilkTruck/glTF-Embedded/CesiumMilkTruck.gltf";	
			
			gltfLoader.load( gltfURL,  loadedGLTF => fnVisualize(loadedGLTF), 
										() => {}, 
										error => alert("Error loading " + gltfURL + ": " + error ) ); //gltfLoader			
		
		
			function fnVisualize(loadedGLTF){

				const data = [																		
							{"name": "Cesium_Milk_Truck_0", "value": 10	},		
							{"name": "Cesium_Milk_Truck_1", "value": 100},		
							{"name": "Cesium_Milk_Truck_2", "value": 40	},	
							{"name": "Wheels001", 			"value": 80	},
							{"name": "Wheels", 				"value": 20	}
						 ];	
			
				// Join data to visual
				var helloDataVisual = new dataVisual();
					helloDataVisual.joinDataToVisual(data, loadedGLTF);  //Join name in data to name in threejs scene
					
				scene.add(helloDataVisual.visual.scene);
				scene.add(new THREE.HemisphereLight(0xffffff,0xffffff,1))
				
				// Position camera on side view of Cesium Truck		
				camera.position.set( -5, 1, 0.5 );
				controls.update();
				
				// Tooltip can be added after renderer has been added to an HTML element and camera added to scene
				helloDataVisual.addToolTip(renderer,camera);
				
				// Animation loop
				animate();

				
				function animate() {
					requestAnimationFrame( animate );
					renderer.render( scene, camera );
				};			
		
			} //fnVisualize
		</script>
		
		
	</body>

</html>
